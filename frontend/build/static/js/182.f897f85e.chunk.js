"use strict";(self.webpackChunkwoodsala_site=self.webpackChunkwoodsala_site||[]).push([[182],{75182:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var r=a(4942),n=a(74165),i=a(1413),s=a(15861),c=a(29439),o=a(72791),l=a(61889),u=a(20890),d=a(64554),p=a(20068),m=a(13400),h=a(27391),x=a(63466),y=a(85523),f=a(94454),v=a(68096),Z=a(88970),_=a(61419),j=a(94721),g=a(36151),b=a(54270),S=a(16679),w=a(76189),C=a(80184),N=(0,w.Z)((0,C.jsx)("path",{d:"M18.3 5.71a.9959.9959 0 0 0-1.41 0L12 10.59 7.11 5.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"}),"CloseRounded"),z=a(59434),I=a(47422),k=a(18986);function D(e){var t=e.size,a=e.localState,r=(e.setState,e.auth),i=e.dispatch;function c(e,t){return o.apply(this,arguments)}function o(){return(o=(0,s.Z)((0,n.Z)().mark((function e(t,a){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i((0,k.CP)({quantity:parseInt(t.target.value),product_id:a})),!r.isAuth||!r.CID){e.next=6;break}return e.next=4,(0,I.$R)({CID:r.CID,product_id:a,quantity:parseInt(t.target.value)});case 4:(s=e.sent)&&console.log(s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=(0,s.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isAuth){e.next=12;break}return e.next=3,(0,I.B8)({CID:r.CID,product_id:t.SKU});case 3:if(!(a=e.sent)){e.next=9;break}return i((0,k.cl)(t.SKU)),e.abrupt("return",i((0,k.br)({variant:"warning",message:a.data.message,open:!0})));case 9:return e.abrupt("return",i((0,k.br)({variant:"error",message:"Something Went Wrong !!!",open:!0})));case 10:e.next=14;break;case 12:return i((0,k.cl)(t.SKU)),e.abrupt("return",i((0,k.br)({variant:"warning",message:"Item removed added to the cart !!!",open:!0})));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,C.jsxs)(l.ZP,{xs:12,md:t,className:"review-order-wrapper flex-utility",children:[(0,C.jsx)(d.Z,{className:"step-heading",children:(0,C.jsx)(u.Z,{variant:"body1",children:"1. Review Your Order"})}),(0,C.jsx)(d.Z,{className:"review-order-inner-wrapper",children:(0,C.jsx)(d.Z,{className:"review-order-products flex-utility",children:a.products.map((function(e,t){return(0,C.jsx)(P,{details:e,removeItemFromCart:p,handleQTY:c,auth:r},t)}))})})]})}function P(e){var t=e.details,a=e.handleQTY,r=e.removeItemFromCart;return(0,C.jsxs)(d.Z,{className:"review-product-card-wrapper flex-utility",children:[(0,C.jsx)(d.Z,{className:"close-icon flex-utility",children:(0,C.jsx)(p.Z,{title:"Remove Product",children:(0,C.jsx)(m.Z,{size:"small",onClick:function(){return r(t)},children:(0,C.jsx)(N,{})})})}),(0,C.jsx)(d.Z,{className:"review-product-img",children:(0,C.jsx)("img",{src:t.image||S.Z,alt:"product_image"})}),(0,C.jsxs)(d.Z,{className:"review-product-card-details flex-utility",children:[(0,C.jsx)(u.Z,{className:"review-text-clip",sx:{fontWeight:500},variant:"body1",children:t.product_title}),(0,C.jsxs)(u.Z,{className:"review-text-clip",variant:"caption",children:["SKU : ",t.SKU]}),(0,C.jsxs)(u.Z,{className:"review-text-clip",variant:"caption",children:["Size : ",t.size]}),(0,C.jsxs)(u.Z,{className:"review-text-clip",variant:"caption",children:["Material : ",t.material]}),(0,C.jsxs)(u.Z,{className:"review-text-clip",variant:"caption",children:["Dispatch By : : ",t.dispatch," days"]}),(0,C.jsx)(h.Z,{InputProps:{startAdornment:(0,C.jsx)(x.Z,{position:"start",children:"Qty"})},size:"small",onChange:function(e){return a(e,t.SKU)},type:"number",value:t.qty||1,small:!0})]}),(0,C.jsx)(d.Z,{className:"review-product-price flex-utility",children:(0,C.jsxs)(u.Z,{sx:{fontWeight:500},variant:"body1",children:["\u20b9 ",t.total]})})]})}function O(e){var t=e.size,a=e.localState,n=e.setState;function i(e){n({type:"Set_Values",payload:(0,r.Z)({},e.target.name,e.target.value)})}return(0,C.jsx)(l.ZP,{xs:12,md:t,className:"delivery-wrapper flex-utility",children:(0,C.jsxs)(d.Z,{className:"delivery-inner-wrapper",children:[(0,C.jsx)(d.Z,{className:"step-heading",children:(0,C.jsx)(u.Z,{variant:"body1",children:"2. Delivery Address"})}),(0,C.jsx)(d.Z,{p:1,children:(0,C.jsx)(u.Z,{variant:"body2",children:"All fields are required."})}),(0,C.jsxs)(d.Z,{className:"delivery-form flex-utility",children:[(0,C.jsx)(h.Z,{required:!0,variant:"outlined",size:"small",name:"customer_email",label:"Email Address",value:a.customer_email||"",onChange:i}),(0,C.jsx)(h.Z,{required:!0,variant:"outlined",size:"small",name:"customer_name",label:"Full Name",value:a.customer_name||"",onChange:i}),(0,C.jsx)(h.Z,{required:!0,variant:"outlined",size:"small",name:"customer_mobile",label:"Mobile Number",value:a.customer_mobile||"",onChange:i}),(0,C.jsx)(h.Z,{required:!0,variant:"outlined",size:"small",name:"pincode",label:"Pincode/ZIP code",value:a.pincode||"",onChange:i}),(0,C.jsx)(h.Z,{required:!0,variant:"outlined",size:"small",name:"shipping",value:a.shipping||"",onChange:i,label:"Shipping Address"}),(0,C.jsx)(h.Z,{required:!0,variant:"outlined",size:"small",name:"city",value:a.city||"",onChange:i,label:"City/Town"}),(0,C.jsx)(h.Z,{required:!0,variant:"outlined",size:"small",name:"state",label:"State/territory",value:a.state||"",onChange:i}),(0,C.jsx)(h.Z,{required:!0,variant:"outlined",disabled:!0,size:"small",name:"country",label:"Country",value:a.country||"",onChange:i}),(0,C.jsx)(y.Z,{control:(0,C.jsx)(f.Z,{size:"small",defaultChecked:!0}),label:"Same billing address "})]})]})})}function q(e){var t=e.size,a=e.localState,r=e.placeSimpleOrder,n=e.displayRazorpay,i=e.setState;return(0,C.jsxs)(l.ZP,{component:"form",xs:12,md:t,className:"payment-method-wrapper flex-utility",method:"post",onSubmit:"COD"===a.pay_method_remaining&&a.codLimit.limit_without_advance>a.total?r:n,encType:"multipart/form-data",children:[(0,C.jsxs)(d.Z,{className:"pay-inner-wrapper",children:[(0,C.jsx)(d.Z,{className:"step-heading",children:(0,C.jsx)(u.Z,{variant:"body1",children:"3. Select Payment Method"})}),(0,C.jsx)(d.Z,{p:1,children:(0,C.jsx)(v.Z,{children:(0,C.jsxs)(Z.Z,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"UPI",name:"payMethod",onChange:function(e){i({type:"Set_State",payload:{pay_method_remaining:e.target.value}})},children:[(0,C.jsx)(y.Z,{value:"card",control:(0,C.jsx)(_.Z,{}),label:"Card"}),(0,C.jsx)(y.Z,{value:"COD",control:(0,C.jsx)(_.Z,{}),label:"Cash On Delivery"}),(0,C.jsx)(y.Z,{value:"UPI",control:(0,C.jsx)(_.Z,{}),label:"UPI (Razorpay)"})]})})})]}),(0,C.jsxs)(d.Z,{className:"order-summary-wrapper",children:[(0,C.jsx)(d.Z,{className:"step-heading",children:(0,C.jsx)(u.Z,{sx:{fontWeight:500,fontSize:"1.1rem"},variant:"button",children:"Order Summary"})}),(0,C.jsxs)(d.Z,{className:"order-summary",children:[(0,C.jsx)(d.Z,{p:1,children:a.products.map((function(e,t){return(0,C.jsx)(U,{details:e},t)}))}),(0,C.jsx)(j.Z,{}),(0,C.jsxs)(d.Z,{className:"order-cal",children:[(0,C.jsxs)(d.Z,{mt:1,sx:{justifyContent:"space-between"},className:"flex-utility",children:[(0,C.jsx)(u.Z,{sx:{fontWeight:500},variant:"h6",children:"Subtotal"}),(0,C.jsxs)(u.Z,{sx:{fontWeight:500},variant:"h6",children:["\u20b9 ",a.subTotal]})]}),(0,C.jsxs)(d.Z,{sx:{justifyContent:"space-between"},className:"flex-utility",children:[(0,C.jsx)(u.Z,{variant:"body1",children:"Shipping"}),(0,C.jsx)(u.Z,{variant:"body1",children:"Free"})]}),(0,C.jsxs)(d.Z,{sx:{justifyContent:"space-between"},className:"flex-utility",children:[(0,C.jsx)(u.Z,{variant:"body1",children:"Tax"}),(0,C.jsx)(u.Z,{variant:"body1",children:" \u20b9 0"})]}),(0,C.jsx)(j.Z,{}),(0,C.jsxs)(d.Z,{mt:2,className:"flex-utility order-total",children:[(0,C.jsx)(u.Z,{variant:"h5",children:"Order Total"}),(0,C.jsxs)(u.Z,{variant:"h5",children:[" \u20b9 ",a.total]})]}),(0,C.jsx)(d.Z,{mt:2,children:(0,C.jsx)(g.Z,{fullWidth:!0,size:"large",variant:"contained",type:"submit",color:"primary",children:"Complete Order"})})]})]})]})]})}function U(e){var t=e.details;return(0,C.jsxs)(d.Z,{className:"order-summary-product flex-utility",children:[(0,C.jsx)(d.Z,{sx:{width:"50%"},children:(0,C.jsx)(u.Z,{className:"review-text-clip",variant:"body1",children:t.product_title})}),(0,C.jsxs)(u.Z,{variant:"body1",children:["X",t.qty]}),(0,C.jsxs)(u.Z,{variant:"body1",children:["\u20b9 ",t.total]})]})}function R(e,t){switch(t.type){case"Set_State":case"Set_Cart":case"Set_Customer":case"Set_Values":return e=(0,i.Z)((0,i.Z)({},e),t.payload);case"Set_Total":var a=t.payload.products;return e=a.length>0?(0,i.Z)((0,i.Z)({},e),{},{subTotal:a.reduce((function(e,t){return e+t.price}),0),total:a.reduce((function(e,t){return e+t.total}),0)}):(0,i.Z)((0,i.Z)({},e),{},{subTotal:0,total:0}),(0,i.Z)({},e);default:return e}}var W=function(){var e=(0,z.I0)(),t=(0,z.v9)((function(e){return e})),a=t.cart,r=t.auth,d={O:"",CID:r.CID||"Not Logged In",status:"processing",customer_name:"",customer_email:"",customer_mobile:"",city:"",state:"",shipping:"",address:[],subTotal:0,total:0,quantity:{},pincode:"",discount:0,paid:0,note:"",CUS:"",GST:null,open:!1,payload:{},classification:"personal",customer_type:"",has_GST:"no",fulfilled:!1,advance_received:!1,pay_method_remaining:"UPI",pay_method_advance:"",inventory_location:"",courier_company:"",AWB:"",billing:"",product_array:[],product_price:{},items:{},customizations:[],discount_per_product:{},country:"India",custom_order:!0,sale_channel:"Online",PO:"",refresh:0,sales_person:"",products:[]},p=(0,o.useReducer)(R,d),m=(0,c.Z)(p,2),h=m[0],x=m[1];function y(e,t){return f.apply(this,arguments)}function f(){return f=(0,s.Z)((0,n.Z)().mark((function t(c,o){var l,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l=(0,i.Z)((0,i.Z)({},h),{},{O:h,orderCreationId:o,razorpayPaymentId:c.razorpay_payment_id,razorpayOrderId:c.razorpay_order_id,razorpaySignature:c.razorpay_signature}),t.next=4,(0,I.m5)(l);case 4:200!==(u=t.sent).status?e((0,k.br)({open:!0,variant:"error",message:u.data.message||"Something Went Wrong !!!"})):(r.isAuth&&Promise.all(a.items.map(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.product_id;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=(0,I.B8)({CID:r.CID,product_id:t.product_id});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e((0,k.RV)({items:[]})),e((0,k.br)({open:!0,variant:"success",message:u.data.message})),e((0,k.SO)({open:!0,payload:h.OID}))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e((0,k.br)({open:!0,variant:"error",message:"Something Went Wrong !!!"}));case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),f.apply(this,arguments)}function v(e){return new Promise((function(t){var a=document.createElement("script");a.src=e,a.onload=function(){t(!0)},a.onerror=function(){t(!1)},document.body.appendChild(a)}))}function Z(){return(Z=(0,s.Z)((0,n.Z)().mark((function e(t){var a,r,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,v("https://checkout.razorpay.com/v1/checkout.js");case 3:if(e.sent){e.next=7;break}return alert("Razorpay SDK failed to load. Are you online?"),e.abrupt("return");case 7:return e.next=9,(0,I.s1)((0,i.Z)((0,i.Z)({},h),{},{limit_without_advance:h.codLimit.limit_without_advance}));case 9:if(200===(a=e.sent).status){e.next=12;break}return e.abrupt("return");case 12:"COD"===h.pay_method_remaining?x({type:"Set_State",payload:{pay_method_advance:"Razorpay"}}):x({type:"Set_State",payload:{pay_method_advance:""}}),r=a.data.id.toString(),s={currency:"INR",name:"WoodShala",description:"Product Order",image:"https://admin.woodshala.in/favicon.ico",order_id:r,handler:function(e){y(e,r)},prefill:{name:h.customer_name,email:h.customer_email,contact:h.customer_mobile},notes:{address:h.shipping},theme:{color:"#91441f"}},new window.Razorpay(s).open();case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=(0,s.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.s_)(JSON.stringify(a.items.map((function(e){return e.product_id}))));case 2:(t=e.sent)&&(r=t.data.map((function(e,t){var r=e[0].categories[0].discount_limit&&e[0].discount_limit>e[0].categories[0].discount_limit?e[0].categories[0].discount_limit:e[0].discount_limit,n=a.items.filter((function(t){return t.product_id===e[0].SKU}))[0].quantity*e[0].selling_price/100*r;return{price:a.items.filter((function(t){return t.product_id===e[0].SKU}))[0].quantity*e[0].selling_price,qty:a.items.filter((function(t){return t.product_id===e[0].SKU}))[0].quantity,discount:n,total:a.items.filter((function(t){return t.product_id===e[0].SKU}))[0].quantity*e[0].selling_price-n,discount_product:r,SKU:e[0].SKU,image:e[0].featured_image||e[0].product_image[0],assembly_part:e[0].assembly_part,size:e[0].length_main+"X"+e[0].breadth+"X"+e[0].height,product_title:e[0].product_title,dispatch:e[0].polish_time+e[0].manufacturing_time,material:e[0].primary_material_name}})),x({type:"Set_Cart",payload:{products:r}}),x({type:"Set_Total",payload:{products:r}}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return(j=(0,s.Z)((0,n.Z)().mark((function t(){var a,i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.CID||!r.isAuth){t.next=9;break}return t.next=3,(0,I.jy)(r.CID);case 3:return(a=t.sent)&&x({type:"Set_Customer",payload:{CID:r.CID,customer_name:a.data.username,customer_email:a.data.email,customer_mobile:a.data.mobile,city:a.data.city,state:a.data.state,shipping:a.data.address.length>0?a.data.address[0].address:""}}),t.next=7,(0,I.l5)(r.CID);case 7:(i=t.sent)&&i.data.length>0&&e((0,k.RV)({items:i.data}));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(){return(g=(0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.PD)();case 2:(t=e.sent)&&x({type:"Set_State",payload:{codLimit:t.data[0]}});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return S=(0,s.Z)((0,n.Z)().mark((function t(i){var c;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i.preventDefault(),t.next=4,(0,I.R)(h);case 4:200===(c=t.sent).status&&(r.isAuth&&Promise.all(a.items.map(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.product_id;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=(0,I.B8)({CID:r.CID,product_id:t.product_id});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e((0,k.RV)({items:[]})),e((0,k.br)({open:!0,variant:"success",message:c.data.message})),e((0,k.SO)({open:!0,payload:h.OID}))),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])}))),S.apply(this,arguments)}return(0,o.useEffect)((function(){!function(){_.apply(this,arguments)}()}),[a]),(0,o.useEffect)((function(){!function(){j.apply(this,arguments)}()}),[r]),(0,o.useEffect)((function(){!function(){g.apply(this,arguments)}()}),[]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(b.q,{children:[(0,C.jsx)("title",{children:"Checkout"}),(0,C.jsx)("meta",{name:"description",content:"Woodsala cart and checkout page."})]}),(0,C.jsx)(l.ZP,{container:!0,className:"Banner",children:(0,C.jsx)(l.ZP,{item:!0,xs:12,children:(0,C.jsx)(u.Z,{variant:"h1",children:"Checkout"})})}),(0,C.jsxs)(l.ZP,{container:!0,className:"checkout-main-container",children:[(0,C.jsx)(D,{auth:r,dispatch:e,localState:h,setState:x,size:3.8}),(0,C.jsx)(O,{dispatch:e,localState:h,setState:x,size:3.8}),(0,C.jsx)(q,{setState:x,dispatch:e,displayRazorpay:function(e){return Z.apply(this,arguments)},placeSimpleOrder:function(e){return S.apply(this,arguments)},localState:h,size:3.8})]})]})}}}]);
//# sourceMappingURL=182.f897f85e.chunk.js.map